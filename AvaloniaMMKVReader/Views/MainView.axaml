<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AvaloniaMMKVReader.ViewModels"
             x:Class="AvaloniaMMKVReader.Views.MainView"
             x:DataType="vm:MainViewModel"
             Background="#1E1E2E">

    <UserControl.Styles>
        <Style Selector="TextBlock">
            <Setter Property="Foreground" Value="#CDD6F4"/>
        </Style>
        
        <Style Selector="Button">
            <Setter Property="Background" Value="#45475A"/>
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        <Style Selector="Button:pointerover">
            <Setter Property="Background" Value="#585B70"/>
        </Style>
        
        <Style Selector="ComboBox">
            <Setter Property="Background" Value="#45475A"/>
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        
        <Style Selector="DataGrid">
            <Setter Property="Background" Value="#313244"/>
            <Setter Property="RowBackground" Value="#313244"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#45475A"/>
        </Style>
        
        <Style Selector="DataGridColumnHeader">
            <Setter Property="Background" Value="#181825"/>
            <Setter Property="Foreground" Value="#89B4FA"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        
        <Style Selector="DataGridCell">
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="Padding" Value="12,6"/>
        </Style>
    </UserControl.Styles>

    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <!-- æ ‡é¢˜æ  -->
        <Border Grid.Row="0" Background="#181825" Padding="16,12">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="ðŸ“¦" FontSize="20" VerticalAlignment="Center"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="MMKV Reader" FontSize="18" FontWeight="Bold" Foreground="#89B4FA"/>
                        <TextBlock Text="MMKV æ•°æ®æ–‡ä»¶è§£æž" FontSize="11" Foreground="#6C7086"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <TextBlock Text="ç±»åž‹:" VerticalAlignment="Center" FontSize="12"/>
                    <ComboBox Width="100" 
                              ItemsSource="{Binding DataTypeOptions}"
                              SelectedItem="{Binding SelectedDataTypeString}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- æ–‡ä»¶é€‰æ‹©åŒºåŸŸ -->
        <Border Grid.Row="1" Margin="12,8,12,0" Padding="16" 
                Background="#313244" CornerRadius="8">
            <Grid RowDefinitions="Auto,Auto">
                <!-- æœªé€‰æ‹©æ–‡ä»¶æ—¶ -->
                <StackPanel HorizontalAlignment="Center" IsVisible="{Binding !HasDataFile}" Spacing="8">
                    <TextBlock Text="ðŸ“" FontSize="36" HorizontalAlignment="Center"/>
                    <TextBlock Text="ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®é€‰æ‹© MMKV æ–‡ä»¶" FontSize="14" 
                               HorizontalAlignment="Center" Foreground="#89B4FA"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="8" Margin="0,8,0,0">
                        <Button Content="é€‰æ‹©æ•°æ®æ–‡ä»¶" Name="SelectDataFileBtn"/>
                        <Button Content="é€‰æ‹© CRC æ–‡ä»¶" Name="SelectCrcFileBtn"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- å·²é€‰æ‹©æ–‡ä»¶æ—¶ -->
                <StackPanel IsVisible="{Binding HasDataFile}" Spacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <TextBlock Text="âœ…" FontSize="14" VerticalAlignment="Center"/>
                        <TextBlock Text="æ•°æ®:" VerticalAlignment="Center" Foreground="#6C7086" FontSize="12"/>
                        <TextBlock Text="{Binding DataFilePath}" VerticalAlignment="Center" 
                                   TextTrimming="CharacterEllipsis" FontSize="12"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="6" IsVisible="{Binding HasCrcFile}">
                        <TextBlock Text="âœ…" FontSize="14" VerticalAlignment="Center"/>
                        <TextBlock Text="CRC:" VerticalAlignment="Center" Foreground="#6C7086" FontSize="12"/>
                        <TextBlock Text="{Binding CrcFilePath}" VerticalAlignment="Center" FontSize="12"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="8" Margin="0,8,0,0">
                        <Button Content="é‡æ–°é€‰æ‹©" Name="ReselectDataFileBtn"/>
                        <Button Content="æ¸…é™¤" Command="{Binding ClearFilesCommand}" 
                                Background="#F38BA8"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- æ•°æ®è¡¨æ ¼ -->
        <Border Grid.Row="2" Margin="12,8,12,0" CornerRadius="8" ClipToBounds="True">
            <Grid>
                <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
                <Border Background="#313244" IsVisible="{Binding IsLoading}" ZIndex="10">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="â³" FontSize="36" HorizontalAlignment="Center"/>
                        <TextBlock Text="æ­£åœ¨è§£æž..." FontSize="14" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- ç©ºçŠ¶æ€ -->
                <Border Background="#313244" IsVisible="{Binding !HasDataFile}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“‹" FontSize="36" HorizontalAlignment="Center" Foreground="#45475A"/>
                        <TextBlock Text="ç­‰å¾…åŠ è½½æ•°æ®..." FontSize="12" Foreground="#6C7086" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- æ•°æ®è¡¨æ ¼ -->
                <DataGrid ItemsSource="{Binding Items}"
                          IsReadOnly="True"
                          CanUserReorderColumns="False"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True"
                          IsVisible="{Binding HasDataFile}"
                          SelectionMode="Single">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="#" Binding="{Binding Index}" Width="50"/>
                        <DataGridTextColumn Header="Key" Binding="{Binding Key}" Width="*"/>
                        <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="2*"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="70"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- çŠ¶æ€æ  -->
        <Border Grid.Row="3" Background="#181825" Padding="12,8">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" 
                           Foreground="#6C7086" FontSize="11" TextTrimming="CharacterEllipsis"/>
                <TextBlock Grid.Column="1" Text="{Binding FileInfo}" VerticalAlignment="Center" 
                           Foreground="#A6E3A1" FontWeight="SemiBold" FontSize="11"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
