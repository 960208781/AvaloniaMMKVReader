<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AvaloniaMMKVReader.ViewModels"
        x:Class="AvaloniaMMKVReader.Views.MainWindow"
        x:DataType="vm:MainViewModel"
        Width="900" Height="650"
        MinWidth="700" MinHeight="500"
        Title="MMKV Reader"
        DragDrop.AllowDrop="True"
        Background="#1E1E2E">

    <Window.Styles>
        <!-- å…¨å±€æ ·å¼ -->
        <Style Selector="TextBlock">
            <Setter Property="Foreground" Value="#CDD6F4"/>
        </Style>
        
        <Style Selector="Button">
            <Setter Property="Background" Value="#45475A"/>
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        <Style Selector="Button:pointerover">
            <Setter Property="Background" Value="#585B70"/>
        </Style>
        <Style Selector="Button:pressed">
            <Setter Property="Background" Value="#6C7086"/>
        </Style>
        
        <Style Selector="ComboBox">
            <Setter Property="Background" Value="#45475A"/>
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        
        <Style Selector="DataGrid">
            <Setter Property="Background" Value="#313244"/>
            <Setter Property="RowBackground" Value="#313244"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#45475A"/>
        </Style>
        
        <Style Selector="DataGridColumnHeader">
            <Setter Property="Background" Value="#181825"/>
            <Setter Property="Foreground" Value="#89B4FA"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        
        <Style Selector="DataGridCell">
            <Setter Property="Foreground" Value="#CDD6F4"/>
            <Setter Property="Padding" Value="12,6"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <!-- æ ‡é¢˜æ  -->
        <Border Grid.Row="0" Background="#181825" Padding="20,16">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <TextBlock Text="ðŸ“¦" FontSize="24" VerticalAlignment="Center"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="MMKV Reader" FontSize="20" FontWeight="Bold" Foreground="#89B4FA"/>
                        <TextBlock Text="MMKV æ•°æ®æ–‡ä»¶è§£æžå·¥å…·" FontSize="12" Foreground="#6C7086"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                    <TextBlock Text="æ•°æ®ç±»åž‹:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                    <ComboBox Width="120" 
                              ItemsSource="{Binding DataTypeOptions}"
                              SelectedItem="{Binding SelectedDataTypeString}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- æ‹–æ”¾åŒºåŸŸ / æ–‡ä»¶é€‰æ‹© -->
        <Border Grid.Row="1" Margin="20,16,20,0" Padding="24" 
                Background="#313244" CornerRadius="12"
                BorderBrush="#45475A" BorderThickness="2"
                Name="DropZone">
            <Grid RowDefinitions="Auto,Auto,Auto">
                <!-- æ‹–æ”¾æç¤º -->
                <StackPanel HorizontalAlignment="Center" IsVisible="{Binding !HasDataFile}">
                    <TextBlock Text="ðŸ“" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                    <TextBlock Text="æ‹–æ”¾ MMKV æ–‡ä»¶åˆ°æ­¤å¤„" FontSize="16" FontWeight="SemiBold" 
                               HorizontalAlignment="Center" Foreground="#89B4FA"/>
                    <TextBlock Text="åŒæ—¶æ‹–å…¥æ•°æ®æ–‡ä»¶å’Œ .crc æ–‡ä»¶ä»¥èŽ·å¾—å®Œæ•´è§£æž" 
                               FontSize="12" HorizontalAlignment="Center" Foreground="#6C7086" Margin="0,4,0,16"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="12">
                        <Button Content="é€‰æ‹©æ•°æ®æ–‡ä»¶" Name="SelectDataFileBtn"/>
                        <Button Content="é€‰æ‹© CRC æ–‡ä»¶" Name="SelectCrcFileBtn"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- å·²é€‰æ‹©æ–‡ä»¶ä¿¡æ¯ -->
                <StackPanel IsVisible="{Binding HasDataFile}" Spacing="8">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="âœ…" FontSize="16" VerticalAlignment="Center" 
                                       IsVisible="{Binding HasDataFile}"/>
                            <TextBlock Text="æ•°æ®æ–‡ä»¶:" VerticalAlignment="Center" Foreground="#6C7086"/>
                            <TextBlock Text="{Binding DataFilePath}" VerticalAlignment="Center" 
                                       TextTrimming="CharacterEllipsis" MaxWidth="400"/>
                        </StackPanel>
                        <Button Grid.Column="2" Content="æ¸…é™¤" Command="{Binding ClearFilesCommand}" 
                                Background="#F38BA8" Padding="12,6"/>
                    </Grid>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8" IsVisible="{Binding HasCrcFile}">
                        <TextBlock Text="âœ…" FontSize="16" VerticalAlignment="Center"/>
                        <TextBlock Text="CRC æ–‡ä»¶:" VerticalAlignment="Center" Foreground="#6C7086"/>
                        <TextBlock Text="{Binding CrcFilePath}" VerticalAlignment="Center"
                                   TextTrimming="CharacterEllipsis" MaxWidth="400"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8" 
                                IsVisible="{Binding !HasCrcFile}">
                        <TextBlock Text="âš ï¸" FontSize="16" VerticalAlignment="Center"/>
                        <TextBlock Text="æœªé€‰æ‹© CRC æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰" VerticalAlignment="Center" Foreground="#FAB387"/>
                        <Button Content="æ·»åŠ  CRC æ–‡ä»¶" Name="AddCrcFileBtn" 
                                Background="Transparent" Foreground="#89B4FA" Padding="8,4"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- æ•°æ®è¡¨æ ¼ -->
        <Border Grid.Row="2" Margin="20,16,20,0" CornerRadius="12" ClipToBounds="True">
            <Grid>
                <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
                <Border Background="#313244" IsVisible="{Binding IsLoading}" ZIndex="10">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center"/>
                        <TextBlock Text="æ­£åœ¨è§£æž..." FontSize="16" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- ç©ºçŠ¶æ€ -->
                <Border Background="#313244" IsVisible="{Binding !HasDataFile}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“‹" FontSize="48" HorizontalAlignment="Center" Foreground="#45475A"/>
                        <TextBlock Text="ç­‰å¾…åŠ è½½æ•°æ®..." FontSize="14" Foreground="#6C7086" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- æ•°æ®è¡¨æ ¼ -->
                <DataGrid ItemsSource="{Binding Items}"
                          IsReadOnly="True"
                          CanUserReorderColumns="True"
                          CanUserResizeColumns="True"
                          CanUserSortColumns="True"
                          IsVisible="{Binding HasDataFile}"
                          SelectionMode="Single">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="#" Binding="{Binding Index}" Width="60"/>
                        <DataGridTextColumn Header="Key" Binding="{Binding Key}" Width="*" MinWidth="150"/>
                        <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="2*" MinWidth="200"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                        <DataGridTextColumn Header="Size" Binding="{Binding RawLength}" Width="60"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- çŠ¶æ€æ  -->
        <Border Grid.Row="3" Background="#181825" Padding="20,12">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" Foreground="#6C7086"/>
                <TextBlock Grid.Column="1" Text="{Binding FileInfo}" VerticalAlignment="Center" 
                           Foreground="#A6E3A1" FontWeight="SemiBold"/>
            </Grid>
        </Border>
    </Grid>
</Window>
